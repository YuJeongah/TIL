SELECT * FROM EMP;

-- 부서별 직급별 연봉 평균을 구하시오

SELECT deptno, titleno, AVG(salary) FROM emp GROUP BY deptno, titleno;


-- 입사연도 별 월급의 평균을 구하시오

SELECT DATE_FORMAT(hdate,'%Y') , AVG(salary)FROM emp GROUP BY DATE_FORMAT(hdate,'%Y');
 
-- 부서 별 입사 월을 기준으로 연봉의 합을 구하시오
SELECT deptno, DATE_FORMAT(hdate, '%m') , SUM(salary) FROM emp GROUP BY deptno, mdate ORDER BY deptno ASC;

-- 부서별 입사월을 기준으로 연봉의 합을 구하시오

SELECT SUM(salary) FROM emp GROUP BY deptno ORDER BY hdate ASC;

-- 이영업이 속한 부서의 연봉의 평균을 구하시오 
SELECT deptno, AVG(salary) FROM emp 
WHERE deptno = (SELECT deptno FROM emp WHERE empname = '이영업');

-- 홍영자와 같은 직급의 평균 연봉보다 많이 받는 직원을 구하시오
SELECT * FROM emp
WHERE salary > (SELECT AVG(salary) FROM emp ORDER BY titleno = '20');

-- 회사 내 매니저는 총 몇명인지 구하시오 
SELECT COUNT(DISTINCT(manager)) AS manager FROM emp;

-- 2000-01-01 부터 2002-12-31일까지 입사한 직원들의 연봉 평균을 구하시오

SELECT AVG(salary) from emp 
where hdate >= '2000-01-01' and hdate <= '2002-12-31';

